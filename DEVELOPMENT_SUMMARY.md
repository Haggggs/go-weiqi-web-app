# 围棋Web App开发经验总结

## 📅 开发周期
**时间**: 2026-02-12 ~ 2026-02-24

**参与角色**:
- Devvi (项目经理/产品经理)
- 阿毛 (全栈开发工程师)

---

## 🎯 开发成果

### 已完成功能
| 功能 | 状态 | 说明 |
|------|------|------|
| 19×19棋盘渲染 | ✅ | SVG + HTML层叠 |
| 落子功能 | ✅ | 点击交叉点落子 |
| 提子规则 | ✅ | 中国规则 |
| 手数显示 | ✅ | 数字标注 |
| 坐标显示 | ✅ | 19-A坐标 |
| 星位标记 | ✅ | 9星位 |
| 规则选择 | ✅ | 中/日/韩规则 |
| SGF保存 | ✅ | 复制/下载 |
| SGF打开 | ✅ | 文件解析 |
| 棋谱库 | ✅ | 搜索/批量抓取 |
| 复盘功能 | ✅ | 前进/后退/跳转 |
| 计时器 | ✅ | 倒计时 |
| 标记工具 | ✅ | 旗子标记 |
| 落子位置修复 | ✅ | 精确交叉点 |

---

## 🚨 经验教训

### 1. 落子位置偏移问题
**问题**: 棋子落在格子中心而非交叉点

**原因**: 
- 点击区域位置公式错误
- 棋子层与网格层坐标系统不一致
- HTML div层与SVG层对标困难

**解决方案**:
- 统一使用SVG坐标系统
- 公式: `margin + index * cellSize`
- 点击区域与棋子使用相同坐标

**教训**: 不同渲染层(HTML/SVG)混用时务必注意坐标对齐

### 2. 开发方向偏离
**问题**: 早期曾错误地将任务从围棋核心功能转向新闻系统

**原因**:
- 需求理解偏差
- 缺乏任务验证机制

**解决方案**:
- 建立错误日志记录
- 制定MVP路线图
- 明确角色分工

**教训**: 开发前必须验证任务是否符合需求文档

### 3. 代码质量与进度平衡
**问题**: 曾因TypeScript严格模式导致构建失败

**解决方案**:
- 适当调整tsconfig.json
- 使用any类型临时绕过
- 保持100%类型覆盖目标

**教训**: 质量标准与进度需要平衡

---

## 🔧 技术架构

### 技术栈
- React 18 + TypeScript
- Vite (构建工具)
- Tailwind CSS (样式)
- SVG (棋盘渲染)

### 文件结构
```
src/
├── components/
│   └── WeiqiBoard.tsx   # 主组件(1200+行)
├── utils/
│   ├── sgf.ts           # SGF棋谱工具
│   └── gameLibrary.ts   # 棋谱库
├── App.tsx              # 入口
└── main.tsx             # React挂载
```

### 渲染层级
1. SVG层 - 网格线/星位/坐标
2. HTML层 - 棋子/点击区域
3. 独立标签页 - 功能面板

---

## 📊 项目统计

- **代码行数**: ~1200行 (WeiqiBoard.tsx)
- **提交次数**: 10+
- **功能模块**: 14+
- **Bug修复**: 5+

---

## 🔜 待完成

1. **T004**: 规则引擎完善(打劫判断)
2. **T005**: 高级计时模式
3. **T014**: 棋谱分享功能
4. **AI对手**: 围棋AI集成

---

## 💡 核心经验

1. **坐标系统统一**: 多层渲染时确保坐标一致
2. **MVP思维**: 优先完成核心功能
3. **快速迭代**: 小步快跑，及时修复
4. **文档记录**: 错误和解决方案都要记录

---

*存档时间: 2026-02-24 18:57*
*记录人: Devvi*
